<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <script src="pkgs/smiles-drawer_mel.js"></script>
  <script src="pkgs/canvas2svg.js"></script>
  <script src="pkgs/fabric.min.js"></script>
  <script src="pkgs/svgcanvas.js"></script>
</head>
<body>
	<canvas id="example-canvas" width="100" height="100"></canvas>
  <script>
    var cmp_width = 100;
    var cmp_height = 100;

/*
	//######### classical #########

	var static_canvas = document.getElementById('output-svg')
	console.log(isElement(static_canvas))
	console.log(static_canvas)
    //makeSVGstrc('[H]N=C(O[H])C1=C([H])N(C2([H])OC([H])(C([H])([H])OP(=O)(O[H])OP(=O)(O[H])OC([H])([H])C3([H])OC([H])(n4c([H])nc5c(N([H])[H])nc([H])nc54)C([H])(OP(=O)(O[H])O[H])C3([H])O[H])C([H])(O[H])C2([H])O[H])C([H])=C([H])C1([H])[H]'.toUpperCase(), 'output-svg', cmp_width, cmp_height);
    //makeSVGstrc('[H]OC(=O)C([H])=C([H])C([H])=C([H])C(=O)O[H]', static_canvas, cmp_width, cmp_height);
	console.log(static_canvas)


	//######### create SVG dynamically ########

	var svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
	svg.id = 'dyn-svg'
	svg.setAttribute("width", "100");
	svg.setAttribute("height", "100");
	//document.body.appendChild(svg)
	console.log(svg)
	document.body.appendChild(svg)
    //makeSVGstrc('[H]N=C(O[H])C1=C([H])N(C2([H])OC([H])(C([H])([H])OP(=O)(O[H])OP(=O)(O[H])OC([H])([H])C3([H])OC([H])(n4c([H])nc5c(N([H])[H])nc([H])nc54)C([H])(OP(=O)(O[H])O[H])C3([H])O[H])C([H])(O[H])C2([H])O[H])C([H])=C([H])C1([H])[H]'.toUpperCase(), 'dyn-svg', cmp_width, cmp_height);
    makeSVGstrc('[H]N=C(O[H])C1=C([H])N(C2([H])OC([H])(C([H])([H])OP(=O)(O[H])OP(=O)(O[H])OC([H])([H])C3([H])OC([H])(n4c([H])nc5c(N([H])[H])nc([H])nc54)C([H])(OP(=O)(O[H])O[H])C3([H])O[H])C([H])(O[H])C2([H])O[H])C([H])=C([H])C1([H])[H]'.toUpperCase(), svg, cmp_width, cmp_height);
	console.log(svg)
	  
  */

	/*
    var canvas = document.createElement('canvas');
	canvas.id = 'test1'
	canvas.width = 500
	canvas.height = 500
    var body = document.getElementsByTagName("body")[0];
    body.appendChild(canvas);
	console.log(canvas)
    makeStrc('[H]OP(=O)(O[H])OP(=O)(O[H])OC([H])([H])C([H])([H])C(=C([H])[H])C([H])([H])[H]', canvas, 500, 500); 
	*/
	var static_canvas = document.getElementById('example-canvas')
	console.log(static_canvas)

	var myMockContext = new C2S(500,500);
	console.log(myMockContext)
	document.body.appendChild(myMockContext.__canvas)

    makeStrc('[H]OP(=O)(O[H])OP(=O)(O[H])OC([H])([H])C([H])([H])C(=C([H])[H])C([H])([H])[H]', myMockContext, 500, 500);


	console.log(myMockContext)
	console.log('++++++++')
	
	myMockContext.getSerializedSvg();
	mysvg = myMockContext.getSvg()
	console.log( mysvg )
	document.body.appendChild(mysvg)




    //Returns true if it is a DOM element    
    function isElement(o){
      return (
	typeof HTMLElement === "object" ? o instanceof HTMLElement : //DOM2
	o && typeof o === "object" && o !== null && o.nodeType === 1 && typeof o.nodeName==="string"
    );
    }


    function makeStrc(input, canvas, width, height) {
      smilesDrawer = new SmilesDrawer.Drawer({ width: width, height: height });
      SmilesDrawer.parse(input, function(tree) {
	    // Draw to the canvas
	    smilesDrawer.draw(tree, canvas, "light", false);
	    // Alternatively, draw to SVG:
	    //svgDrawer.draw(tree, canvas, 'dark', false);
	  });
    }

    function makeSVGstrc(input, in_html_element, in_width, in_height) {
      svgDrawer = new SmilesDrawer.SvgDrawer({ width: in_width, height: in_height, explicitHydrogens: false, bondThickness: 0.8, atomVisualization: 'default'});
      SmilesDrawer.parse(input, function(tree) {
	    // draw to the canvas
	    //smilesdrawer.draw(tree, in_canvas, "light", false);
	    // alternatively, draw to svg:
	    svgDrawer.draw(tree, in_html_element, 'light', false);
	  });
    }
  </script>
</body>
