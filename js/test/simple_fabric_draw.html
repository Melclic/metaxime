<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <script src="pkgs/d3.v6.js"></script>
  <script src="pkgs/smiles-drawer.js"></script>
  <script src="pkgs/fabric.min.js"></script>
</head>
<body>
  <script>

	//Use the canvas to svg to convert
	//WARNING: using this function will not work since we need to add the canvas to the dody before rendering
	let canvasElement = document.createElement("canvas");
	var body = document.getElementsByTagName("body")[0];
	canvasElement.width = '300';
	canvasElement.height = '300';
    body.appendChild(canvasElement);
	console.log(canvasElement)
	let faCanvas = new fabric.Canvas(canvasElement);	
	//var newCanvas = new fabric.Canvas('newCanvas');
	console.log(canvasElement)
	console.log(faCanvas)
	//canvasDrawStrc('[H]OP(=O)(O[H])OP(=O)(O[H])OC([H])([H])C([H])([H])C(=C([H])[H])C([H])([H])[H]', canvasElement, 300, 300);
	//canvasDrawStrc('[H]OP(=O)(O[H])OP(=O)(O[H])OC([H])([H])C([H])([H])C(=C([H])[H])C([H])([H])[H]', faCanvas.lowerCanvasEl, 300, 300);
	canvasDrawStrc('[H]OP(=O)(O[H])OP(=O)(O[H])OC([H])([H])C([H])([H])C(=C([H])[H])C([H])([H])[H]', faCanvas.upperCanvasEl, 300, 300);
	console.log(faCanvas)

	console.log(faCanvas.toSVG())



	//################ function ###################

    //Returns true if it is a DOM element
    function isElement(o){
      return (
    typeof HTMLElement === "object" ? o instanceof HTMLElement : //DOM2
    o && typeof o === "object" && o !== null && o.nodeType === 1 && typeof o.nodeName==="string"
    );
    }


	function canvasDrawStrc(input, canvas, width, height) {
    smilesDrawer = new SmilesDrawer.Drawer({ width: width, height: height });
    SmilesDrawer.parse(input, function(tree) {
          // Draw to the canvas
          smilesDrawer.draw(tree, canvas, "light", false);
          // Alternatively, draw to SVG:
          //svgDrawer.draw(tree, canvas, 'dark', false);
	});
  }
  </script>
</body>
